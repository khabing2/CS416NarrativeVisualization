<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Digital Transformation of Public Libraries</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: white;
            border-bottom: 2px solid #e0e0e0;
            padding: 40px 0;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 300;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #7f8c8d;
            margin-bottom: 30px;
        }

        .description {
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.1rem;
            color: #555;
            text-align: left;
        }

        .description p {
            margin-bottom: 15px;
        }

        .visualization-container {
            background-color: white;
            margin: 40px 0;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .scene-title {
            font-size: 1.8rem;
            font-weight: 400;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .scene-description {
            font-size: 1rem;
            color: #666;
            margin-bottom: 30px;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .control-group label {
            font-size: 0.9rem;
            color: #555;
            font-weight: 500;
        }

        select, button {
            padding: 8px 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            background-color: white;
            cursor: pointer;
        }

        button {
            background-color: #3498db;
            color: white;
            border: none;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2980b9;
        }

        button.active {
            background-color: #2c3e50;
        }

        .chart-container {
            width: 100%;
            height: 500px;
            margin: 20px 0;
        }

        .navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .nav-button {
            padding: 12px 24px;
            font-size: 1rem;
            border-radius: 6px;
        }

        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .annotation {
            fill: #e74c3c;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .axis {
            font-size: 0.8rem;
            color: #666;
        }

        .grid line {
            stroke: #e0e0e0;
            stroke-width: 1;
        }

        .grid path {
            stroke-width: 0;
        }

        footer {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 60px;
        }

        .data-source {
            font-size: 0.9rem;
            color: #bdc3c7;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>The Digital Transformation of Public Libraries</h1>
            <p class="subtitle">A Data-Driven Story of Change (2012-2022)</p>
            <div class="description">
                <p>Over the past decade, public libraries have undergone a remarkable transformation. While traditional services like book circulation have declined, libraries have evolved into digital community hubs offering new services and resources.</p>
                <p>This interactive visualization explores how libraries adapted to changing community needs, examining differences between urban and rural libraries, and across different library sizes. Navigate through three key scenes to discover how libraries reinvented themselves for the digital age.</p>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Scene 1: Traditional Services Decline -->
        <div id="scene1" class="visualization-container">
            <h2 class="scene-title">Scene 1: The Decline of Traditional Services</h2>
            <p class="scene-description">
                Physical circulation and library visits show a steady decline as digital alternatives emerge. 
                Explore how this trend varies by library size and location.
            </p>
            
            <div class="controls">
                <div class="control-group">
                    <label for="library-size-1">Library Size:</label>
                    <select id="library-size-1">
                        <option value="all">All Libraries</option>
                        <option value="small">Small (< 25,000 population)</option>
                        <option value="medium">Medium (25,000-100,000)</option>
                        <option value="large">Large (> 100,000)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="location-1">Location:</label>
                    <select id="location-1">
                        <option value="all">All Locations</option>
                        <option value="urban">Urban</option>
                        <option value="rural">Rural</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="metric-1">View:</label>
                    <button id="per-capita-1" class="active">Per Capita</button>
                    <button id="raw-numbers-1">Total Numbers</button>
                </div>
            </div>
            
            <div id="chart1" class="chart-container"></div>
            
            <div class="navigation">
                <button class="nav-button" onclick="goToScene(2)">Next: Digital Revolution →</button>
            </div>
        </div>

        <!-- Scene 2: Digital Growth -->
        <div id="scene2" class="visualization-container" style="display: none;">
            <h2 class="scene-title">Scene 2: The Digital Revolution</h2>
            <p class="scene-description">
                As traditional services declined, libraries invested heavily in digital resources and technology. 
                See how electronic collections and computer usage transformed library services.
            </p>
            
            <div class="controls">
                <div class="control-group">
                    <label for="digital-metric">Digital Services:</label>
                    <select id="digital-metric">
                        <option value="electronic">Electronic Collections</option>
                        <option value="computer">Computer Usage</option>
                        <option value="internet">Internet Sessions</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="comparison-2">Compare By:</label>
                    <select id="comparison-2">
                        <option value="size">Library Size</option>
                        <option value="location">Urban vs Rural</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="animation-2">Animation:</label>
                    <button id="replay-2">Replay Growth</button>
                </div>
            </div>
            
            <div id="chart2" class="chart-container"></div>
            
            <div class="navigation">
                <button class="nav-button" onclick="goToScene(1)">← Previous</button>
                <button class="nav-button" onclick="goToScene(3)">Next: Community Hubs →</button>
            </div>
        </div>

        <!-- Scene 3: Community Programming -->
        <div id="scene3" class="visualization-container" style="display: none;">
            <h2 class="scene-title">Scene 3: Libraries as Community Hubs</h2>
            <p class="scene-description">
                Modern libraries have embraced their role as community centers, dramatically increasing programming 
                and events. Discover how libraries became vital community spaces.
            </p>
            
            <div class="controls">
                <div class="control-group">
                    <label for="program-type">Program Type:</label>
                    <select id="program-type">
                        <option value="total">Total Programs</option>
                        <option value="children">Children's Programs</option>
                        <option value="adult">Adult Programs</option>
                        <option value="attendance">Program Attendance</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="size-filter-3">Size Filter:</label>
                    <input type="range" id="size-filter-3" min="1" max="3" value="3">
                    <span id="size-label-3">All Sizes</span>
                </div>
                <div class="control-group">
                    <label for="comparison-3">Time Comparison:</label>
                    <button id="compare-years-3">2012 vs 2022</button>
                </div>
            </div>
            
            <div id="chart3" class="chart-container"></div>
            
            <div class="navigation">
                <button class="nav-button" onclick="goToScene(2)">← Previous</button>
                <button class="nav-button" onclick="goToScene(1)">Start Over</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p class="data-source">
                Data Source: Institute of Museum and Library Services (IMLS) Public Library Survey
            </p>
        </div>
    </footer>

    <!-- Tooltip -->
    <div id="tooltip" class="tooltip"></div>

    <script>
        // Global parameters
        const params = {
            currentScene: 1,
            selectedYear: 2022,
            librarySize: 'all',
            location: 'all',
            metric: 'per_capita'
        };

        // Scene navigation
        function goToScene(sceneNumber) {
            // Hide all scenes
            document.getElementById('scene1').style.display = 'none';
            document.getElementById('scene2').style.display = 'none';
            document.getElementById('scene3').style.display = 'none';
            
            // Show selected scene
            document.getElementById(`scene${sceneNumber}`).style.display = 'block';
            params.currentScene = sceneNumber;
            
            // Load scene data
            loadSceneData(sceneNumber);
        }

        // Data loading and visualization functions will go here
        function loadSceneData(sceneNumber) {
            switch(sceneNumber) {
                case 1:
                    loadScene1Data();
                    break;
                case 2:
                    loadScene2Data();
                    break;
                case 3:
                    loadScene3Data();
                    break;
            }
        }

        function loadScene1Data() {
            // Load and visualize traditional library services data
            console.log('Loading Scene 1 data...');
        }

        function loadScene2Data() {
            // Load and visualize digital services data
            console.log('Loading Scene 2 data...');
        }

        function loadScene3Data() {
            // Load and visualize programming data
            console.log('Loading Scene 3 data...');
        }

        // Initialize the visualization
        document.addEventListener('DOMContentLoaded', function() {
            loadSceneData(1);
        });
    </script>
</body>
</html>
